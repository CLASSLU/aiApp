# 开发测试指南

## 首次开发准备
```bash
# 克隆仓库
git clone https://github.com/your-org/ai-media-platform.git
cd ai-media-platform

# 初始化Python环境
python -m venv venv
source venv/bin/activate  # Linux/Mac
# 或 .\venv\Scripts\Activate  # Windows

# 安装依赖
pip install -r requirements.txt

# 前端依赖安装 (如需)
cd frontend && npm install
```

## 服务启停命令

### 后端服务
```bash
# 启动开发模式（热重载）
export FLASK_APP=src/app.py
export SILICONFLOW_API_KEY=your_key
flask run --port=5000 --debug

# 生产模式启动
gunicorn -w 4 'src.app:create_app()' -b :5000

# 停止服务
pkill -f "flask run"  # 或 Ctrl+C
```

### 前端服务
```bash
# 开发模式
cd frontend
npm run dev

# 生产构建
npm run build

# 快速预览（Python）
python -m http.server 3000 -d frontend
```

## 测试执行规范

### 单元测试
```bash
# 运行全部测试
pytest tests/ -v

# 仅运行本地接口测试
pytest tests/local/ -m local -v

# 生成覆盖率报告
pytest --cov=src --cov-report=html
```

### 集成测试
```bash
# 远程API测试（需有效API密钥）
export SILICONFLOW_API_KEY=your_prod_key
pytest tests/remote/ -m remote -v
```

## 调试工具
```bash
# 查看请求日志
tail -f src/logs/app.log

# 检查环境变量
python -c "import os; print(os.environ.get('SILICONFLOW_API_KEY'))"

# 测试API端点
curl -X POST http://localhost:5000/api/health
```

## 代码质量检查
```bash
# Python静态检查
flake8 src/ --max-line-length=120

# 前端代码格式化
cd frontend && npx prettier --write .
```

## 容器化操作
```bash
# 构建并启动服务
docker-compose up -d --build

# 查看容器日志
docker-compose logs -f backend

# 执行容器内测试
docker-compose exec backend pytest tests/local/
```

## 环境清理
```bash
# 清理Python环境
deactivate
rm -r venv/

# 清理前端构建
cd frontend && rm -r node_modules/ dist/
``` 